<div class="container marketing">
  <% if session[:user_id] %>
    <% if params[:id].to_i == @current_user.id %>
      <h1>Welcome back, <%= @user.name %>!</h1>
      <p><%= link_to "Create a New Cookbook", new_cookbook_path, class: "btn btn-default" %>
        <%= link_to "Add New Recipe", new_recipe_path, class: "btn btn-default"  %>
        <%= link_to "See all your ingredients", ingredients_path %></p>
    <% else %>
      <h1><%= @user.name %> cookbooks</h1>
    <% end %>
  <% else %>
    <h1><%= @user.name %> cookbooks</h1>
  <% end %>

  <hr class="featurette-divider">

  <% unless @cookbooks.length == 0 && @recipes.length == 0 %>
    <h3><mark>Cookbooks:</mark></h3><br>

    <div class="row">
      <% @cookbooks.each do |cookbook| %>
        <div class="col-md-4">

          <% if cookbook.image_url %>
            <%= image_tag cookbook.image_url, class:"img-thumbnail", size: "220x200" %>
          <% elsif cookbook.photo_url %>
            <%= image_tag cookbook.photo_url, class:"img-thumbnail", size: "220x200" %>
          <% else %>
            <%= image_tag "no_image.png", class:"img-thumbnail", size: "220x200" %>
          <% end %>

          <h2><%= cookbook.name %></h2>
          <p>Recipes: <%= cookbook.recipes.count %> Ingredients: <%= cookbook.ingredients.count %></p>
          <p>Description: <%= cookbook.description %></p>
          <div class="btn-toolbar">
            <p><%= link_to "View details", cookbook_path(cookbook.id), class: "btn btn-default" %>
            <% if session[:user_id] %>
              <% if params[:id].to_i == @current_user.id %>
                <%= link_to "Edit Cookbook", edit_cookbook_path(cookbook), class: "btn btn-warning" %>
                <%= link_to "Delete Cookbook", cookbook_path(cookbook), method: :delete, class: "btn btn-danger", data: { confirm: "Are you sure you want to delete this?"} %>
                </p><br><br>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>

    <h3><mark>Recipes:</mark></h3>
    <hr class="featurette-divider">

      <div class="row">
        <% @recipes.each do |recipe| %>
          <div class="col-md-4">

            <% if recipe.photo_url %>
              <%= image_tag recipe.photo_url, class:"img-circle", size: "220x200" %>
            <% elsif recipe.image_url %>
              <%= image_tag recipe.image_url, class:"img-circle", size: "220x200"  %>
            <% else %>
              <%= image_tag "no_image.png", class:"img-circle", size: "220x200"  %>
            <% end %>

            <h2><%= recipe.name %></h2>
            <p><%= link_to "View details", recipe_path(recipe.id), class: "btn btn-default" %>

          </div>
        <% end %>
      </div>
  <% else %>
    <p>You haven't added any cookbooks or recipes yet!</p>
  <% end %>
  </div>
